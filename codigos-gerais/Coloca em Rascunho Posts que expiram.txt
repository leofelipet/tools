// Verificar a data de expiração e colocar os posts em modo rascunho
function verificar_data_expiracao_pacotes() {
    $args = array(
        'post_type' => 'pacotes',
        'posts_per_page' => -1, // Obter todos os posts do CPT "pacotes"
    );

    $pacotes_query = new WP_Query($args);

    if ($pacotes_query->have_posts()) {
        while ($pacotes_query->have_posts()) {
            $pacotes_query->the_post();
            $data_expiracao = get_post_meta(get_the_ID(), 'data-de-expiracao', true); // Obter a data de expiração do metabox
			if($data_expiracao == '') {
				return;
			} else {
			if (strtotime($data_expiracao) < current_time('timestamp')) {
				// A data de expiração é maior do que a data atual
                wp_update_post(array(
                    'ID' => get_the_ID(),
                    'post_status' => 'draft', // Colocar o post em modo rascunho
                ));
			}
			}
        }
        wp_reset_postdata();
    }
}

verificar_data_expiracao_pacotes();